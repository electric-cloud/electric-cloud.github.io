<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
      <meta name="description" content="">
      <meta name="author" content="">
      <link rel="shortcut icon" type="image/png" href="images/favicon.ico">
      <title>Electric Cloud Open Source</title>
      <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
      <!-- Latest compiled and minified CSS -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
      <!-- Optional theme -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
      <!-- Latest compiled and minified JavaScript -->
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
   </head>
   <body>
      <div class="container">
         <div class="header clearfix">
            <nav>
               <ul class="nav nav-pills pull-right">
                  <li role="presentation"><a id = "introRef" href="index.html">Intro</a></li>
                  <li role="presentation" class="active"><a id="docsRef" href="docs.html">Docs</a></li>
                  <li role="presentation"><a href="https://github.com/electriccommunity/">Github</a></li>
               </ul>
            </nav>
            <h3 class="text-muted">Welcome to Electric Cloud Open Source</h3>
         </div>
         <img class="img-responsive" src="images/echero_lines_resize.jpg" alt="header image">
         <div class="row marketing">
          <div id="plugins" class="col-md-4">
               <a href="#quickstart">Quick Start</a>
               <br/>
               <br/>
               <a href="#buildProcess">Build & Deploy</a>
               <br/>
               <br/>
			   <a href="#contributing">Getting involved</a>
               <br/>
               <br/>
			   <a href="#moreInformation">More information</a>
               <br/>
               <br/>
            </div>
		  <div id="content" class="col-md-8">
            <div id="quickstart">
			<h2>Quick Start</h2>
               <p>This quick start guide will walk you through the steps for enhancing and packaging a hello world ElectricCloud plugin to introduce you to the process of building and developing the ElectricCloud open source plugins.</p>
			   <p>
                You will need the following to follow along with the quick start guide:
				<ul>
					<li><b>JDK 7 or higher</b> <p>Open a terminal and check the JDK version on your system by running: <pre>java -version</pre> If you do not have the right JDK version, <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">download and install it</a> on your system.</p></li>
					<li><b>Git or GitHub Desktop</b> <p>You can use Git directly from the command line or you can use GitHub Desktop on Mac and on Windows. Please <a href="https://help.github.com/articles/set-up-git/">install and set up Git</a> and <a href="https://help.github.com/articles/set-up-git/">GitHub Desktop</a>(if required) before continuing with the guide.</p></li>
					<li><b>Access to an ElectricFlow server</b> <p>We will install a hello world ElectricCloud plugin as part of this quick start guide, so you should have access to a running ElectricFlow server with privileges to install plugins on it.</p></li>
				</ul>
                </p>
				<br/>
				<h4>Checking out from Github</h4>
			    <p>
                The quick start guide uses EC-HelloWorld, a simple hello world plugin, so we start by checking it out from GitHub.
                </p>
				<p>If you are using Git directly, then run the following commands to get the EC-HelloWorld plugin code on your system.
				<pre>
mkdir myplugins
cd myplugins
git clone https://github.com/electric-cloud/EC-HelloWorld.git</pre>
				</p>
				<p>Or, if you are using GitHub Desktop, then you can clone the plugin code by clicking on the <img src="images/github_clone_in_desktop.png" alt="Clone in Desktop"> button in the <a href="https://github.com/electric-cloud/EC-HelloWorld">Github EC-HelloWorld plugin repository</a>.</p>
			   <br/>
			   <p>At this point, you should have the complete EC-HelloWorld plugin code on your system in a <i>myplugins/EC-HelloWorld</i> directory with the directory structure looking like this:
				   <p>
				   <img src="images/plugin_code_structure.png" class="img-responsive" alt="Plugin code structure">			   
				   </p>
			   </p>
			   <br/>
			   <h4>Building the plugin</h4>
				   <p>
				   Go to the <i>myplugins/EC-HelloWorld</i> directory and run the following command.
				   <pre>gradlew</pre>
				   Since this is the first time you are building the plugin, it might take close to a minute to build the plugin since the GWT classes need to be compiled. Subsequent builds should not take more than a few seconds to complete.
				   </p>
				   <p>Once the build has completed successfully, you can find the plugin jar inside <i>build/EC-HelloWorld/</i> within the <i>myplugins/EC-HelloWorld</i> directory.</p>
				   
			   <br/>
			   <h4>Installing the plugin</h4>
				   <p>Lets do a quick check to make sure that our plugin works as promised before we make our enhancements to the plugin. Start by installing the plugin jar on the ElectricFlow server using these steps:
				   <ol>
					   <li>Login to the ElectricFlow server</li>
					   <li>Go to <b>Automations->Administration->Plugins</b></li>
					   <li>Select the <b>Install from File/URL</b> tab</li>
					   <li>Choose the plugin jar file from <i>myplugins/EC-HelloWorld</i> directory and click the <b>Upload</b> button to install the plugin.</li>
				   </ol>
				   </p>
				   <p>Once the plugin is installed, you can view it on the <b>Currently Installed</b> tab on the <b>Plugins</b> page. Lets try out the plugin using the following steps:
				   <ol>
					   <li>Click on the <b>EC-HelloWorld</b> plugin link on the <b>Plugins</b> page.</li>
					   <li>Click on the <b>SayHello</b> procedure.</li>
					   <li>Select the <b>Run->Run Immediately</b> option.</li>
				   </ol>
				   </p>
				   <p>The plugin procedure job should complete successfully with the expected 'Hello World':
					   <img src="images/hello_world_result.png" class="img-responsive" alt="Hello World plugin result">			   
				   </p>
			   <br/>
			   <h4>Enhancing the plugin</h4>
				<p>Now lets make a small enhancement to the plugin code and see how we would build the plugin again with the change and install it.</p>
			    <p>Start by opening the file <i>myplugins/EC-HelloWorld/src/main/resources/project/procedures/sayHello.pl</i> in your favourite text editor. This is the Perl script that prints 'Hello World' when we run the <b>SayHello</b> procedure. Update the script by adding the first 3 lines before the 'Hello World' message is printed.
				<pre>
# Sign the message with the host name of the agent running the procedure
my $hostName = "$[/myResource/hostName]";
$msg .= " [Signed] - $hostName";

# Add the above 3 lines before this block
# Set the message in the job summary as well as print it in the step logs.
$ec->setProperty("summary", $msg . "\n");
print $msg;
</pre> 
				</p>
				<p>Lets rebuild and install the plugin now.
				<ol>
				<li>Go to the <i>myplugins/EC-HelloWorld</i> directory and run:
				   <pre>gradlew</pre>
				   Once the build has completed successfully, you can find the updated plugin jar inside <i>build/EC-HelloWorld/</i> within the <i>myplugins/EC-HelloWorld</i> directory.
				</li>
				<li>Install the updated plugin jar on the ElectricFlow server using the steps described earlier.</li>
				<li>Run the <b>SayHello</b> procedure again.</li>
				</ol>
				</p>
				<p>The plugin procedure job should complete successfully with our enhanced 'Hello World' message:
					<img src="images/enhanced_hello_world_result.png" class="img-responsive" alt="Enhanced Hello World result">			   
				</p>
			   <br/>
			   
			   <h4>Next steps</h4>
			   <p>
				We have only just scratched the surface with this Quick Start guide. There is a lot you can do with plugins. You can learn more about the ElectricCloud open source plugins <a href="index.html">here</a>. 
               </p>
			  <br/>
              <br/>
			</div>
			<!-- /quickstart -->
            <div id="buildProcess">
               <h2>Building and deploying the plugin</h2>
               <p>We use a <a href="https://github.com/electric-cloud/flow-gradle-plugin">gradle plugin</a> to compile, test and install our plugins.</p>
			   </br>
			   <h4>To clean prior build artifacts</h4>
			   <p>
               <pre>gradlew clean</pre>
               </p>
			   </br>
               <h4>To compile the plugin</h4>
               <p>
               <pre>gradlew</pre>
               </p>
			   </br>
			   <h4>Install the plugin</h4>
			   </br>
			   <p>
                 <b>Note</b>: ectool is needed to for this functionality. Find more information on how to install ectool <a href="http://docs.electric-cloud.com/eflow_doc/FlowIndex.html">here</a>.
			   </p>
               <p>			   
				 Set the COMMANDER_HOME environment variable
			   </p>
			   <p>
				 These commands set the COMMANDER_HOME environment variable for the current terminal session and sets it to the default ElectricFlow install directory.
			   </p>
			   <p>			   
				 Windows: <pre>set COMMANDER_HOME=C:\Program Files\Electric Cloud\ElectricCommander</pre>
				 Linux: <pre>export COMMANDER_HOME=/opt/electriccloud/electriccommander</pre>
               </p>
			   <p><b>CAUTION:</b> This will install the plugin to the specified ElectricFlow server. It is highly recommended to use a development ElectricFlow server during plugin development.</p>
			   <pre>gradlew -PcommanderServer=[serverAddress] -PcommanderUser=[userName] -PcommanderPassword=[password] deploy</pre>
			   
            </div>
			<!-- /contributing -->
            <br/>
            <br/>
			<div id="contributing">
			<h2>Getting involved</h2>
			  <p>
                  We value contributions whether it’s documentation, bugfixes, new features or improved test coverage. We follow the GitHub pull request model described <a href="https://help.github.com/articles/using-pull-requests/">here</a>. 
              </p>
			<br/>
            <br/>
			  <h2 id="moreInformation">More information</h2>
			  <p> <a href="https://guides.github.com/introduction/flow//">The GitHub Flow guide by Github</a> </p>
			  <p> <a href="https://18f.gsa.gov/2015/03/03/how-to-use-github-and-the-terminal-a-guide/">18F has has a detailed guide on how to use Github and send a pull request.</a> </p>
            </div>
			<br/>
            <br/>
			
         <footer class="footer">
            <p>&copy; Electric Cloud 2015</p>
         </footer>
        </div>
	  <!-- /content -->
	  </div>
	  <!-- /row marketing -->
      <!-- /container -->
   </body>
</html>